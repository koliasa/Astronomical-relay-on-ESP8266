## Астрономічне Реле на ESP8266

Цей код для платформи ESP8266 дозволяє керувати реле в залежності від астрономічних даних, а також за ручним графіком. Реле може вмикатись і вимикатись автоматично згідно годин сходу та заходу сонця, а також відповідно до вручну заданих годин вмикання та вимикання.

**Основні Можливості:**

1. **Ручне Управління:** Користувач може вмикати та вимикати освітлення вручну за допомогою фізичних кнопок. Для цього в системі передбачені кнопки управління для кожної зони освітлення.

2. **Автоматичне Управління:** Система автоматично керує освітленням в залежності від часу доби. Освітлення вмикається автоматично на підставі налаштуваних годин ранку та заходу сонця, що дозволяє ефективно використовувати природне світло.

3. **Адаптація до Умов Середовища:** Система може адаптувати рівень освітленості залежно від зовнішніх умов. Вона автоматично підлаштовує яскравість освітлення в залежності від рівня природного світла за вікном та в приміщенні.

4. **Синхронізація з Глобальним Часом:** Система синхронізується з глобальним часом через Інтернет за допомогою служби NTP (Network Time Protocol). Це дозволяє точно визначити години ранку та заходу сонця незалежно від регіону.

5. **Вимірювання Рівня Освітленості:** Система використовує фотоелементи для вимірювання рівня освітленості як всередині приміщення, так і на вулиці. Це допомагає адаптувати освітлення до різних умов.

6. **Інтеграція з OpenWeatherMap:** Для отримання даних про погоду та час сходу/заходу сонця використовується зовнішній сервіс OpenWeatherMap. Це дозволяє системі актуалізувати інформацію щодо умов зовнішнього середовища.

7. **Настройка Розкладу Адаптивного Режиму:** Користувач може налаштовувати розклад автоматичної адаптації освітлення для кожного дня тижня окремо. Це дозволяє визначити, коли саме система буде використовувати адаптивний режим.

### Перелік необхідного обладнання та компонентів

- ESP8266 Development Board (NodeMCU або подібний модуль)
- Реле (2 штуки) або 1 двоканальне реле
- Кнопки (2 штуки)
- Резистори (2 штуки, приблизно 10 кОм)
- Дріт та перехідники
- USB-кабель
- Джерело живлення (USB-адаптер або батарея)
- ПК або ноутбук

### Параметри

- `ssid` та `password`: Налаштування для підключення до Wi-Fi мережі.
- `ntpServer`, `gmtOffset`, та `daylightOffset`: Параметри для синхронізації з NTP сервером для отримання точного часу.
- `relayPin1`, `relayPin2`: Піни для підключення реле для управління освітленням.
- `buttonPin1`, `buttonPin2`: Піни для підключення кнопок ручного керування освітленням.
- `adaptiveRelayPin`: Пін для підключення реле для автоматичного адаптивного режиму.
- `adaptiveButtonPin`: Пін для підключення кнопки переключення автоматичного адаптивного режиму.
- `apiKey`, `city`, `country`: Параметри для отримання астрономічних даних (сходу/заходу сонця) з OpenWeatherMap.

**Параметри Розкладу Адаптивного Режиму:**

- `adaptiveSchedule`: Масив булевих значень для налаштування розкладу автоматичної адаптації освітлення для кожного дня тижня окремо.

**Параметри Часового Режиму:**

- `manualOnHour1`, `manualOffHour1`: Години ввімкнення та вимкнення освітлення першої зони в ручному режимі.
- `manualOnHour2`, `manualOffHour2`: Години ввімкнення та вимкнення освітлення другої зони в ручному режимі.
- `desiredLumensIndoor`, `desiredLumensOutdoor`: Бажані рівні освітленості для внутрішнього та зовнішнього простору.

### Налаштування Параметрів

```cpp
const int relayPin1 = D1; - Пін для керування першим реле
const int relayPin2 = D2; - Пін для керування другим реле
const int adaptiveRelayPin = D3; - Пін для керування адаптивним реле
const int buttonPin1 = D5; - Пін для першої кнопки
const int buttonPin2 = D6; - Пін для другої кнопки
const int adaptiveButtonPin = D7; - Пін для кнопки адаптивного керування
const char* apiKey = "openweathermap_api_key"; - Ключ API для веб-сервісу OpenWeatherMap
const char* city = "Ternopil"; - Місто для отримання погодних даних
const char* country = "UA"; - Країна для отримання погодних даних
const int photocellIndoorPin = A0; - Аналоговий пін для вимірювання освітленості в приміщенні
const int photocellOutdoorPin = A0; // Використовуйте A0 або інший доступний аналоговий пін - Аналоговий пін для вимірювання освітленості на вулиці
bool adaptiveSchedule[7] = {true, true, true, true, true, true, true}; - Розклад для адаптивного керування, де true вказує на активність для кожного дня тижня
const int manualOnHour1 = 10; - Година ввімкнення ручного керування першим реле
const int manualOffHour1 = 16; - Година вимкнення ручного керування першим реле
const int manualOnHour2 = 18; - Година ввімкнення ручного керування другим реле
const int manualOffHour2 = 22; - Година вимкнення ручного керування другим реле
const int desiredLumensIndoor = 500; - Бажане значення освітленості в приміщенні
const int desiredLumensOutdoor = 300; - Бажане значення освітленості на вулиці
```

2. **Ручний режим керування**: За допомогою кнопок на платі ESP8266 можна вручну вмикати та вимикати кожне реле незалежно. Це дозволяє вам контролювати освітлення вручну за необхідності.

3. **Автоматичне зсування годин**: Враховуючи пору року, реле буде вмикатись та вимикатись на пізніших чи раніших годинах, щоб відповідати періодам сходу та заходу сонця. Це допомагає забезпечити оптимальне освітлення в будь-яку пору року.

### Використання

1. Підключіть ESP8266 до вашої Wi-Fi мережі, встановивши правильні значення для параметрів `ssid` та `password`.

2. Для отримання точного часу та астрономічних даних відкоригуйте параметри `ntpServer`, `gmtOffset` та `daylightOffset` згідно вашого місця та налаштувань.

3. Підключіть реле та кнопки для ручного керування до відповідних пінів на ESP8266.

4. Вкажіть ваш API ключ OpenWeatherMap (`apiKey`) та інформацію про місто (`city`) та країну (`country`), щоб отримувати астрономічні дані.

5. Завантажте цей код на ESP8266 та спостерігайте, як автоматичний режим освітлення адаптується до астрономічних умов, а ручний режим дозволяє вам контролювати освітлення вручну.

6. Для встановлення ручного режиму, натисніть відповідну кнопку. Для включення/виключення освітлення в ручному режимі натисніть відповідну кнопку в моменти, вказані параметрами `manualOnHour1`, `manualOffHour1`, `manualOnHour2` та `manualOffHour2`.

7. Якщо потрібно, налаштуйте `desiredLumensIndoor` та `desiredLumensOutdoor` для досягнення бажаного рівня освітленості.

8. Розклад автоматичного режиму для кожного дня тижня налаштовується за допомогою масиву `adaptiveSchedule`. Встановіть значення `true` або `false` для кожного дня, враховуючи свої вимоги.

### Світлові стандарти для різних типів приміщень
```txt
+--------------------------+-----------------------+-----------------------+
| Тип приміщення           | Європа (мін - макс)   | США (мін - макс)      |
+--------------------------+-----------------------+-----------------------+
| Офісні приміщення         | 300 - 750 люмен       | 500 - 1000 люмен     |
| Комерційні приміщення     | 300 - 1000 люмен      | 500 - 1500 люмен     |
| Склад                     | 150 - 500 люмен       | 200 - 500 люмен      |
| Гараж та парковка         | 50 - 200 люмен        | 50 - 300 люмен       |
| Будівельний майданчик     | 50 - 200 люмен        | 50 - 300 люмен       |
| Приватна інфраструктура   | 150 (основне) - 750   | 200 (основне) - 750  |
+--------------------------+-----------------------+-----------------------+
```
